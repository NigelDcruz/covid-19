let allCaseNo=document.getElementById("allCaseNo"),recoveredCaseNo=document.getElementById("recoveredCaseNo"),deathCaseNo=document.getElementById("deathCaseNo"),dataFor=document.getElementById("dataFor"),byGraphdata=document.getElementById("byGraphdata"),selectCountry=document.getElementById("selectCountry"),submitCountry=document.getElementById("submitCountry"),tableRow=document.getElementById("table-row"),LoadingDiv=document.getElementById("LoadingDiv"),chartContainer=document.getElementById("chart-container");function numberWithCommas(e){var t=(r=(e+=".00").split(".",2))[1],a=parseInt(r[0]);if(isNaN(a))return"";var n="";a<0&&(n="-"),a=Math.abs(a);for(var o=new String(a),r=[];o.length>3;){var l=o.substr(o.length-3);r.unshift(l),o=o.substr(0,o.length-3)}return o.length>0&&r.unshift(o),o=r.join(","),(r=(e=n+(e=t.length<1?o:o+"."+t)).split(".",2))[0]}function sum(e){if("[object Array]"!==toString.call(e))return!1;for(var t=0,a=0;a<e.length;a++)isNaN(e[a])||(t+=Number(e[a]));return t}function compare(e,t){const a=e.country.toUpperCase(),n=t.country.toUpperCase();let o=0;return a>n?o=1:a<n&&(o=-1),o}let handleReplaceAllCasesValues=(e,t,a)=>{e=numberWithCommas(e),t=numberWithCommas(t),a=numberWithCommas(a),allCaseNo.innerText=e,recoveredCaseNo.innerText=t,deathCaseNo.innerText=a},handleReplaceDataFor=e=>{dataFor.innerText=e,byGraphdata.innerText=e};function initChart(e,t,a,n){clearChart();let o=document.getElementById("covidCasesChart").getContext("2d");new Chart(o,{type:"bar",data:{labels:["All Cases","Recovered Cases","Death Cases","Added Today"],datasets:[{barPercentage:.5,label:"",borderColor:"rgba(0,0,0)",backgroundColor:["#40ffc3","#c9f941","#f93030","blue"],data:[e,t,a,n]}]},options:{responsive:!0,maintainAspectRatio:!1,Bar:.8,legend:{labels:{fontSize:25,padding:20,boxWidth:0}},tooltips:{bodyFontSize:25,callbacks:{label:function(e){return numberWithCommas(e.yLabel)},title:function(){}},displayColors:!1},scales:{yAxes:[{gridLines:{display:!1},ticks:{fontStyle:"bold"}}]}}})}function generateAnyChart(e,t,a,n,o){clearChart();let r=document.getElementById("covidCasesChart").getContext("2d");new Chart(r,{type:`${o}`,data:{labels:["All Cases","Recovered Cases","Death Cases","Added Today"],datasets:[{barPercentage:.5,label:"",borderColor:"rgba(0,0,0)",backgroundColor:["#86c6be","#a6c64c","#c80003","blue"],data:[e,t,a,n]}]},options:{responsive:!0,maintainAspectRatio:!1,Bar:.8,legend:{labels:{fontSize:25,padding:20,boxWidth:0}},tooltips:{bodyFontSize:25,callbacks:{label:function(e){return numberWithCommas(e.yLabel)},title:function(){}},displayColors:!1},scales:{yAxes:[{gridLines:{display:!1},ticks:{fontStyle:"bold"}}]}}})}$("#accordion_search_bar").on("keyup",function(){var e=$(this).val().toLowerCase();e.length<=1&&$(this).removeClass("show"),$("#accordion .card").filter(function(){console.log($(this).text().toLowerCase().indexOf(e)>-1),$(this).text().toLowerCase().indexOf(e)>-1?$(this).show().addClass("there"):$(this).hide().removeClass("there")}),$("#accordion .card.there").length<1?$(".noRelult").addClass("show"):$(".noRelult").removeClass("show")}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),document.querySelector(this.getAttribute("href")).scrollIntoView({behavior:"smooth"})})}),$(".navbar-nav .nav-link").on("click",function(){$(".navbar-nav").find(".active").removeClass("active"),$(this).addClass("active")});let renderCovidChart=(e,t,a,n)=>{initChart(e,t,a,n)},clearChart=()=>{chartContainer.innerHTML="",chartContainer.innerHTML='<canvas id="covidCasesChart"></canvas>'};function populateCountries(e){if(210==$("option").length)return;let t=document.createElement("option"),a=document.createAttribute("class");a.value="selectCountryOpptions",t.setAttributeNode(a);let n=document.createAttribute("value");n.value=`${e}`,t.setAttributeNode(n);let o=document.createTextNode(`${e}`);t.appendChild(o),selectCountry.appendChild(t)}function populateTable(e,t,a,n,o,r){tableRow.innerHTML="",setTimeout(()=>{let l=`<tr>\n\t\t\t\t\t\t\t\t<td> <img src="${r}" alt="${e}"/>${e}</td>\n\t\t\t\t\t\t\t\t<td class="color-neutral">${numberWithCommas(t)}</td>\n\t\t\t\t\t\t\t\t<td class="color-green">${numberWithCommas(a)}</td>\n\t\t\t\t\t\t\t\t<td class="color-red">${numberWithCommas(n)}</td>\n\t\t\t\t\t\t\t\t<td class="color-today">${numberWithCommas(o)}</td>\n\t\t\t\t\t\t\t</tr>`;tableRow.innerHTML+=l},0)}async function loadInitialData(){let e,t=await fetch("https://corona.lmao.ninja/all"),a=await t.json(),n=await fetch("https://corona.lmao.ninja/countries"),o=await n.json(),r=a.cases,l=a.deaths,s=a.recovered,i=[];o.sort(compare),o.forEach(t=>{populateTable(t.country,t.cases,t.recovered,t.deaths,t.todayCases,t.countryInfo.flag),i.push(t.todayCases),e=sum(i)}),handleReplaceAllCasesValues(r,s,l),handleReplaceDataFor("All Countries"),renderCovidChart(r,s,l,e);var c=new Date(a.updated);let d=c.getFullYear(),u=["January","February","March","April","May","June","July","August","September","October","November","December"][c.getMonth()],h=c.getDate(),m=new Intl.DateTimeFormat("default",{hour12:!0,hour:"numeric",minute:"numeric"}).format(c);document.getElementById("lastUpdated").innerHTML=`${h} ${u} ${d} at ${m}`,o.forEach(e=>{populateCountries(e.country)})}async function renderNewData(e){let t=await fetch(`https://corona.lmao.ninja/countries/${e}`),a=await t.json(),n=a.country,o=a.cases,r=a.deaths,l=a.recovered,s=a.todayCases;renderCovidChart(o,l,r,s),populateTable(n,o,l,r,s,a.countryInfo.flag)}loadInitialData(),$("#selectCountry").on("change",function(){if("All"==selectCountry.value){let e="All Countries";return loadInitialData(),void handleReplaceDataFor(e)}handleReplaceDataFor(selectCountry.value),renderNewData(selectCountry.value)});